@model EventSphere.Models.User

@{
    ViewBag.Title = "Register";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mt-5" style="max-width: 500px;">
    <div class="card shadow-sm border-0 rounded-3">
        <div class="card-body p-4">
            <h3 class="text-center mb-4 fw-bold">Create Account</h3>

            @if (ViewBag.Error != null)
            {
                <div class="alert alert-danger">@ViewBag.Error</div>
            }

            @using (Html.BeginForm("Register", "Account", FormMethod.Post, new { @class = "needs-validation" }))
            {
                @Html.AntiForgeryToken()

                <div class="form-group mb-3">
                    <asp:Label for="FullName" class="form-label" runat="server">Full Name</asp:Label>
                    @Html.TextBoxFor(m => m.FullName, new { @class = "form-control", placeholder = "Enter your full name", required = "required" })
                    @Html.ValidationMessageFor(m => m.FullName, "", new { @class = "text-danger" })
                </div>

                <div class="form-group mb-3">
                    <asp:Label for="Phone" class="form-label" runat="server">Phone Number</asp:Label>
                    @Html.TextBoxFor(m => m.Phone, new { @class = "form-control", placeholder = "Enter your phone number", type = "tel", pattern = "[0-9]{10}", title = "Enter a valid 10-digit phone number", required = "required" })
                    @Html.ValidationMessageFor(m => m.Phone, "", new { @class = "text-danger" })
                </div>

                <div class="form-group mb-3">
                    <asp:Label for="Gender" class="form-label" runat="server">Gender</asp:Label>
                    @Html.DropDownListFor(m => m.Gender,
                        new List<SelectListItem> {
                            new SelectListItem { Value = "" , Text = "Select your Gender" },
                            new SelectListItem { Value = "Male" , Text = "Male" },
                            new SelectListItem { Value = "Female" , Text = "Female" },
                            new SelectListItem { Value = "Other" , Text = "Prefer not to say" }
                        },
                        new { @class = "myselect" })
                    @Html.ValidationMessageFor(m => m.Gender, "", new { @class = "text-danger" })
                </div>

                <div class="form-group mb-3">
                    <asp:Label for="DateOfBirth" class="form-label" runat="server">Date Of Birth</asp:Label>
                    @Html.TextBoxFor(m => m.DateOfBirth, new { @class = "form-control", type = "date", required = "required" })
                    @Html.ValidationMessageFor(m => m.Phone, "", new { @class = "text-danger" })
                </div>

                <div class="form-group mb-3">
                    <asp:Label for="Address" class="form-label" runat="server">Address</asp:Label>
                    @Html.TextBoxFor(m => m.Address, new { @class = "form-control", placeholder = "Enter your address", required = "required" })
                    @Html.ValidationMessageFor(m => m.Address, "", new { @class = "text-danger" })
                </div>

                <div class="form-group mb-3">
                    <asp:Label for="Email" class="form-label" runat="server">Email Address</asp:Label>
                    @Html.TextBoxFor(m => m.Email, new { @class = "form-control", placeholder = "Enter your email", type = "email", required = "required" })
                    @Html.ValidationMessageFor(m => m.Email, "", new { @class = "text-danger" })
                </div>

                <div class="form-group mb-3">
                    <asp:Label for="PasswordHash" class="form-label" runat="server">Password</asp:Label>
                    @Html.PasswordFor(m => m.PasswordHash, new { @class = "form-control", placeholder = "Enter your password", required = "required", minlength = "6" })
                    @Html.ValidationMessageFor(m => m.PasswordHash, "", new { @class = "text-danger" })
                </div>

                <div class="form-group mb-3">
                    <asp:Label for="ConfirmPassword" class="form-label" runat="server">Confirm Password</asp:Label>
                    <input id="ConfirmPassword" type="password" name="ConfirmPassword" class="form-control" placeholder="Re-enter your password" required minlength="6" />
                </div>

                <div class="d-grid mb-3">
                    <button type="submit" class="btn btn-success btn-block">Register</button>
                </div>

                <div class="text-center">
                    <small>
                        Already have an account?
                        <a href="@Url.Action("Login", "Account")" class="text-decoration-none fw-semibold">Login here</a>
                    </small>
                </div>
            }
        </div>
    </div>
</div>

@section scripts {
    <script>
        // Client-side password match validation
        document.querySelector("form").addEventListener("submit", function (e) {
            const pass = document.getElementById("PasswordHash").value;
            const confirm = document.getElementById("ConfirmPassword").value;

            if (pass !== confirm) {
                e.preventDefault();
                alert("Passwords do not match. Please try again.");
            }
        });
    </script>
}